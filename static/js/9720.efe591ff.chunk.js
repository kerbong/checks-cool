"use strict";(self.webpackChunkchecks_cool=self.webpackChunkchecks_cool||[]).push([[9720],{9720:(e,t,n)=>{n.d(t,{Z:()=>T});const a="Attendance_student__zQCyC",s="Attendance_form-section__SmTcW",l="Attendance_date__PNNb3",o="Attendance_closeBtn__E609D",i="Attendance_datepick-explain__LXpeq",d="Attendance_holidayData__72cLY";var c=n(3451),r=n(7313),u=n(5186),m=n(658),v=n.n(m),h=n(7287),p=n(4484),f=n(7114),x=n.n(f);const b="AttendanceOption_option__04AUt",_="AttendanceOption_option-select__5pc8P",j="AttendanceOption_ul__HzrL4";var S=n(6417);const g=e=>{var t,n,a;const[s,l]=(0,r.useState)((null===(t=e.selectOption)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.value)||"");(0,r.useEffect)((()=>{e.showNote(s)}),[s]);const o=e=>{l(e.target.id+e.target.innerText)};return(0,S.jsx)("ul",{className:j,children:e.selectOption&&(null===(a=e.selectOption)||void 0===a?void 0:a.map((e=>(0,S.jsx)("li",{className:e.value===s?_:b,id:e.id,onClick:o,children:e.class},e.id))))})};var N=n(5729),A=n(7692),w=n(7121),D=n(650),y=n(573);const Z="AudioRecord_audio-controls__2Hajc",k="AudioRecord_audio__B9hmM",C="AudioRecord_audio-container__Q7SBV",F="AudioRecord_fileUploadBtn__9aPc1",Y="AudioRecord_addRecordFile__J2UkD",H="AudioRecord_downRecordFile__EhfPR",M="AudioRecord_audio-btns__0DaJq";var O=n(2050);const U="audio/mp4",R=e=>{const[t,n]=(0,r.useState)(!1),a=(0,r.useRef)(null),[s,l]=(0,r.useState)("inactive"),[o,i]=(0,r.useState)(null),[d,c]=(0,r.useState)([]),[u,m]=(0,r.useState)([]),[h,p]=(0,r.useState)(null),[f,b]=(0,r.useState)(null),[_,j]=(0,r.useState)("00:00"),g=()=>{l("inactive"),a.current.stop(),a.current.onstop=()=>{const e=new Blob(d,{type:U});m(e);const t=URL.createObjectURL(e);p(t),c([])}};(0,r.useEffect)((()=>{let t;if("recording"===s){let e;j("00:00"),null===f?(e=v()().format("YYYY-MM-DD HH:mm:ss"),b(e)):e=f,t=setInterval((()=>{let t=v()().format("YYYY-MM-DD HH:mm:ss"),n=v()(t).diff(v()(e).format("YYYY-MM-DD HH:mm:ss"),"s"),a=Math.floor(+n/60),s=Math.floor(+n%60);a<10&&(a="0"+a),s<10&&(s="0"+s),j(a+":"+s)}),1e3)}else"inactive"===s&&h&&(b(null),clearInterval(t),x().fire("\ub179\uc74c \uc885\ub8cc","\ub179\uc74c\uc774 \uc885\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \uc800\uc7a5\ud558\uc2dc\ub824\uba74 [\ud30c\uc77c\ucd94\uac00] \ub97c \ub204\ub974\uc2e0 \ud6c4, [\uc800\uc7a5]\uc744 \ub20c\ub7ec\uc8fc\uc138\uc694!","warning"),e.uploadAudio(u));return()=>clearInterval(t)}),[s]);const N=e=>{x().fire("\uc2dc\uac04 \uc81c\ud55c","\uc790\ub3d9 \uc885\ub8cc\uae4c\uc9c0 ".concat(e,"\ubd84 \ub0a8\uc558\uc2b5\ub2c8\ub2e4."),"info")};(0,r.useEffect)((()=>{null!==f&&("05:00"===_?N(3):"07:00"===_?N(1):"08:00"===_&&g())}),[_]);return(0,S.jsx)(S.Fragment,{children:(0,S.jsxs)("div",{className:Z,children:[(0,S.jsx)("div",{className:C,children:(0,S.jsx)("audio",{src:h,controls:!0,className:k})}),(0,S.jsxs)("div",{className:M,children:[_,"\ucd08"," ",t?null:(0,S.jsxs)("button",{onClick:async()=>{if("MediaRecorder"in window)try{const e=await navigator.mediaDevices.getUserMedia({audio:!0,video:!1});n(!0),i(e)}catch(e){x().fire("\uc5d0\ub7ec!","".concat(e.message,", \ubb38\uc81c\uac00 \uc9c0\uc18d\ub418\uba74 kerbong@gmail.com / \uc7bc\uc7bc-\uc774\uac70\ud574\uc694 \uc5d0 \uc54c\ub824\uc8fc\uc138\uc694!"),"warning")}else alert("\ud604\uc7ac \ube0c\ub77c\uc6b0\uc800\uc5d0\uc11c \uc2e4\ud589\uc774 \ubd88\uac00\ub2a5\ud55c \uae30\ub2a5\uc785\ub2c8\ub2e4! \ud06c\ub86c\uc5d0\uc11c \uc2e4\ud589\ud574\uc8fc\uc138\uc694!")},type:"button",className:H,children:[(0,S.jsx)(O.uYL,{}),"\ub9c8\uc774\ud06c \uad8c\ud55c"]}),t&&"inactive"===s?(0,S.jsxs)("button",{onClick:async()=>{l("recording");const e=new MediaRecorder(o,{type:U});a.current=e,a.current.start();let t=[];a.current.ondataavailable=e=>{"undefined"!==typeof e.data&&0!==e.data.size&&t.push(e.data)},c(t)},type:"button",className:F,children:[(0,S.jsx)(O.uoU,{})," ",h?"\ub2e4\uc2dc\ub179\uc74c":"\ub179\uc74c"]}):null,"recording"===s?(0,S.jsxs)("button",{onClick:g,type:"button",className:F,children:[(0,S.jsx)(O.wTG,{}),"\uc911\uc9c0"]}):null]}),(0,S.jsx)("div",{className:M,children:h&&(0,S.jsx)(S.Fragment,{children:(0,S.jsx)("button",{onClick:()=>{e.uploadAudio(u)},className:Y,children:"\ud30c\uc77c \ucd94\uac00"})})})]})})},B=e=>{var t;const[n,a]=(0,r.useState)(""),[s,l]=(0,r.useState)(""),[o,i]=(0,r.useState)(!1),[d,c]=(0,r.useState)(!1),[u,m]=(0,r.useState)(!1),[f,b]=(0,r.useState)(!1),[_,j]=(0,r.useState)(!1),[Z,k]=(0,r.useState)([]),[C,F]=(0,r.useState)(!1),[Y,H]=(0,r.useState)([]),[M,U]=(0,r.useState)([]),B=(0,r.useRef)(null);(0,r.useEffect)((()=>{(()=>{let t=(0,y.JU)(D.wO,"attend",e.userUid);(0,y.cf)(t,(e=>{if(e.exists()){var t,n;const a=[];null===e||void 0===e||null===(t=e.data())||void 0===t||null===(n=t.attend_data)||void 0===n||n.forEach((e=>{a.push(e)})),k([...a])}else k([])}))})()}),[e.userUid]);const E=e=>e.getFullYear()+"-"+("0"+(1+e.getMonth())).slice(-2)+"-"+("0"+e.getDate()).slice(-2),T=async t=>{t.preventDefault();const l=document.getElementById("textArea").value,o=e.who.split(" ");let c="";if("consulting"===e.about){c=E(e.attendDate)+(("0"+(r=e.attendDate).getHours()).slice(-2)+":"+("0"+r.getMinutes()).slice(-2))+o[0];const t={num:o[0],name:o[1],id:c,option:s,note:l,attachedFileUrl:n,related:Y};e.addData(t)}else if("attendance"===e.about){let t,n;if(Array.isArray(e.attendDate)?[t,n]=e.attendDate:(t=e.attendDate,n=e.attendDate),0===t.getDay()||6===t.getDay())return void x().fire({icon:"error",title:"\uc800\uc7a5\uc5d0 \uc2e4\ud328\ud588\uc5b4\uc694!",html:"\ud1a0 / \uc77c\uc694\uc77c\uc740 \uc800\uc7a5\uc774 \ubd88\uac00\ub2a5\ud569\ub2c8\ub2e4. <br>\ub0a0\uc9dc\ub97c \ud655\uc778, \ubcc0\uacbd\ud574\uc8fc\uc138\uc694",confirmButtonText:"\ud655\uc778",confirmButtonColor:"#85bd82"});let a={num:o[0],name:o[1],option:s,note:l};"1\uad50\uc678\uccb4\ud5d8"===s||"3\uac00\uc815\ud559\uc2b5"===s?(a.request=u,a.report=f):a.paper=d;let i=[],r=t;if(t===n){c=E(t)+o[0]+" "+v()().format("HH:mm"),i.push(c)}else for(;r<=n;)if(0===r.getDay()||6===r.getDay())r.setDate(r.getDate()+1);else{c=E(r)+o[0]+" "+v()().format("HH:mm"),i.push(c),r.setDate(r.getDate()+1)}let m=JSON.parse(JSON.stringify(Z));i.forEach((e=>{(null===Z||void 0===Z?void 0:Z.filter((t=>{var n,a,s;return(null===(n=t.id)||void 0===n||null===(a=n.split(" "))||void 0===a?void 0:a[0])===(null===e||void 0===e||null===(s=e.split(" "))||void 0===s?void 0:s[0])}))).length<3?m.push({...a,id:e}):x().fire("\uc800\uc7a5 \uc2e4\ud328","\ucd9c\uacb0\uc790\ub8cc\ub294 \ud559\uc0dd\ub2f9 \ud558\ub8e8\uc5d0 3\uac1c \uae4c\uc9c0\ub9cc \uc800\uc7a5\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.","error")})),await(0,y.pl)((0,y.JU)(D.wO,"attend",e.userUid),{attend_data:m})}var r,m;m="".concat(o[1]," \ud559\uc0dd\uc758 ").concat(s.slice(1)," \uc815\ubcf4\uac00 \uc800\uc7a5\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \n(5\ucd08 \ud6c4 \ucc3d\uc774 \uc790\ub3d9\uc73c\ub85c \uc0ac\ub77c\uc9d1\ub2c8\ub2e4.)"),x().fire({icon:"success",title:"\uc800\uc7a5\ub418\uc5c8\uc5b4\uc694!",text:m,confirmButtonText:"\ud655\uc778",confirmButtonColor:"#85bd82",timer:5e3}),i(!1),a(""),e.onClose()};return(0,r.useEffect)((()=>{"attendance"===e.about&&(async()=>{var t,n,a;let s=(0,y.JU)(D.wO,"attend",e.userUid),l=[];const o=await(0,y.QT)(s);var i;if(o.exists()&&(l=null===(i=o.data())||void 0===i?void 0:i.attend_data),!l||0===(null===(t=l)||void 0===t?void 0:t.length)||0===(null===(n=e.students)||void 0===n?void 0:n.length))return;let d=null===(a=l)||void 0===a?void 0:a.filter((t=>{var n,a,s,l;return(null===t||void 0===t?void 0:t.name)===(null===(n=e.who)||void 0===n?void 0:n.substring((null===(a=e.who)||void 0===a?void 0:a.indexOf(" "))+1))&&(null===t||void 0===t?void 0:t.num)===(null===(s=e.who)||void 0===s||null===(l=s.split(" "))||void 0===l?void 0:l[0])})),c=[];null===d||void 0===d||d.forEach((e=>{c.push(e.option)})),U(c)})()}),[e.students]),(0,S.jsxs)(S.Fragment,{children:[C&&(0,S.jsx)(w.Z,{who:e.who,confirmBtnHandler:()=>F(!1),studentClickHandler:t=>(t=>{var n;let a=t.target.innerText,s=[...Y];if(a!==e.who){var l;null!==(n=s)&&void 0!==n&&n.includes(a)?s=null===(l=s)||void 0===l?void 0:l.filter((e=>e!==a)):s.push(a),H(s)}})(t),students:e.students,isSubject:e.isSubject,relatedStudent:Y,closeModalHandler:()=>{F(!1),H([])}}),(0,S.jsx)(g,{selectOption:e.selectOption,showNote:e=>{i(!0),l(e)}}),"attendance"===e.about&&(null===M||void 0===M?void 0:M.length)>0&&(0,S.jsx)(S.Fragment,{children:(0,S.jsxs)("span",{className:h.Z.optionsSet,children:[(0,S.jsx)("span",{className:h.Z.optionsSet,children:"* \uc800\uc7a5\ub41c \ucd9c\uacb0\uc815\ubcf4:"}),null===(t=[...new Set(M)])||void 0===t?void 0:t.map((e=>(0,S.jsxs)("span",{className:h.Z.optionsSet,children:["\ud83d\ude42",null===e||void 0===e?void 0:e.slice(1)," ",null===M||void 0===M?void 0:M.filter((t=>t===e)).length,"\uc77c"]},"optionSet-".concat(e))))]})}),"attendance"===e.about&&0===(null===M||void 0===M?void 0:M.length)&&(0,S.jsx)("span",{className:h.Z.optionsSet,children:"* \uc800\uc7a5\ub41c \ucd9c\uacb0 \uc790\ub8cc\uac00 \uc5c6\uc5b4\uc694!"}),"consulting"===e.about&&(0,S.jsxs)("div",{className:h.Z.btnArea,children:[(0,S.jsxs)("div",{className:h.Z.relStdArea,children:[(0,S.jsx)("b",{children:"\uc120\ud0dd\ub41c \uad00\ub828\ud559\uc0dd"}),(0,S.jsx)("div",{className:h.Z.relStdShowDiv,children:(null===Y||void 0===Y?void 0:Y.length)>0&&(null===Y||void 0===Y?void 0:Y.map((e=>(0,S.jsx)("span",{className:h.Z["margin-5"],children:e},e))))})]}),(0,S.jsx)(A.Z,{className:"consult-relatedStdBtn",name:"\uad00\ub828\ud559\uc0dd",onclick:function(){F(!C)}})]}),o&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)("form",{id:"area-form",className:h.Z.form,onSubmit:T,children:["attendance"===e.about&&(0,S.jsx)(S.Fragment,{children:"1\uad50\uc678\uccb4\ud5d8"===s||"3\uac00\uc815\ud559\uc2b5"===s?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(A.Z,{className:u?"paperSub-btn-clicked":"paperSub-btn",onclick:e=>{e.preventDefault(),m((e=>!e))},title:"\uc2e0\uccad\uc11c",name:"\uc2e0\uccad\uc11c"}),(0,S.jsx)(A.Z,{className:f?"paperSub-btn-clicked":"paperSub-btn",onclick:e=>{e.preventDefault(),b((e=>!e))},title:"\ubcf4\uace0\uc11c",name:"\ubcf4\uace0\uc11c"})]}):(0,S.jsx)(S.Fragment,{children:(0,S.jsx)(A.Z,{className:d?"paperSub-btn-clicked":"paperSub-btn",onclick:e=>{e.preventDefault(),c((e=>!e))},title:"\uc11c\ub958",name:"\uc11c\ub958"})})}),(0,S.jsx)(p.Z,{ref:B,id:"textArea",className:"attendForm-input",label:"inputData",input:{type:"textarea",placeholder:"\ube44\uace0\ub97c \uc785\ub825\ud558\uc138\uc694.",autoFocus:!0},defaultValue:"",onInput:t=>(t=>{let n;"consulting"===e.about?n=4e3:"attendance"===e.about&&(n=30),t.target.value.length>n&&(t.target.value=t.target.value.substr(0,n),x().fire({icon:"error",title:"\uc785\ub825 \ubd88\uac00",text:"\uc785\ub825\ud55c \ub0b4\uc6a9\uc744 \uc904\uc5ec\uc8fc\uc138\uc694.",confirmButtonText:"\ud655\uc778",confirmButtonColor:"#85bd82",timer:5e3}))})(t)})]}),(0,S.jsx)("div",{className:h.Z.btnArea,style:{justifyContent:"center"},children:"consulting"===e.about?(0,S.jsx)(S.Fragment,{children:_?(0,S.jsx)(N.Z,{about:e.about,attachedFileHandler:e=>{a(e)}}):(0,S.jsx)(R,{userUid:e.userUid,uploadAudio:e=>{a(e)}})}):(0,S.jsx)(N.Z,{about:e.about,attachedFileHandler:e=>{a(e)}})}),(0,S.jsxs)("div",{className:h.Z.btnArea,style:"attendance"===e.about?{justifyContent:"center"}:{},children:["consulting"===e.about&&(0,S.jsx)(S.Fragment,{children:(0,S.jsxs)("button",{className:h.Z.btn,onClick:()=>j((e=>!e)),style:{fontSize:"1em"},children:[(0,S.jsx)(O.Rc_,{})," ",_?"\uc624\ub514\uc624 \ub179\uc74c\ud558\uae30":"\uc0ac\uc9c4 \uc62c\ub9ac\uae30"]})}),(0,S.jsx)("button",{className:h.Z.btn,onClick:T,style:"attendance"===e.about?{width:"98%"}:{width:"50%"},children:"\uc800\uc7a5"})]})]})]})};var E=n(7984);const T=e=>{const[t,n]=(0,r.useState)(new Date),[m,h]=(0,r.useState)(!1),[p,f]=(0,r.useState)(v()().format("YYYY-MM")),x=e=>{f(v()(e).format("YYYY-MM"))};return(0,r.useEffect)((()=>{"consulting"===e.about&&p&&(null===E.Z||void 0===E.Z||E.Z.forEach((e=>{if(e[0]===p){let t=e[1].split("*"),n=document.querySelectorAll(t[0])[0];if(!n)return;if(n.classList.contains("eventAdded"))return;const a=document.createElement("button");a.className="".concat(d," eventBtn"),a.innerText=t[1],null===n||void 0===n||n.appendChild(a),n.style.borderRadius="5px",n.classList.add("eventAdded")}})))}),[p,m]),(0,r.useEffect)((()=>{if("attendance"===e.about)return;let t=document.querySelector(".react-datepicker__day-names"),n=document.querySelectorAll(".react-datepicker__day-name");t&&n&&(t.style.width="95%",n[0].style.width="14%",n[6].style.width="14%")}),[m]),(0,S.jsxs)(c.Z,{onClose:e.onClose,addStyle:"attendHeight",children:[(0,S.jsxs)("div",{className:a,children:[(0,S.jsxs)("span",{children:[" ",e.who," "]}),(0,S.jsx)("span",{className:o,onClick:e.onClose,children:(0,S.jsx)(O.zu6,{})})]}),(0,S.jsxs)("div",{className:l,onClick:()=>h((e=>!e)),children:[" ",(0,S.jsx)(u.Z,{filterNone:"consulting"===e.about&&!0,getDateValue:e=>{n(e)},about:e.about,isSubject:e.isSubject,getMonthValue:x,getYearValue:x})]}),(0,S.jsx)("div",{className:i,children:"attendance"===e.about&&"*\uc2dc\uc791 \ub0a0\uc9dc\uc640 \ub05d \ub0a0\uc9dc\ub97c \uc120\ud0dd\ud574\uc8fc\uc138\uc694!"}),(0,S.jsx)("div",{className:s,children:(0,S.jsx)(B,{id:e.id,selectOption:e.selectOption,students:e.students,attendDate:t,about:e.about,addData:t=>e.addData(t),userUid:e.userUid,who:e.who,onClose:e.onClose})})]})}},7121:(e,t,n)=>{n.d(t,{Z:()=>d});n(7313);var a=n(3451),s=n(3776),l=n(7287),o=n(7692),i=n(6417);const d=e=>{var t,n;return(0,i.jsxs)(a.Z,{onClose:e.closeModalHandler,children:[e.who,(0,i.jsxs)("h2",{className:l.Z.btnArea,children:["\uad00\ub828\ud559\uc0dd \ub4f1\ub85d",(0,i.jsxs)("div",{children:[(0,i.jsx)(o.Z,{name:"\ucde8\uc18c",className:"student-add",style:{width:"50px",backgroundColor:"#ff6600a6"},onclick:()=>{e.closeModalHandler()}}),(0,i.jsx)(o.Z,{name:"\ud655\uc778",style:{width:"50px",backgroundColor:"#ff6600a6"},className:"student-add",onclick:e.confirmBtnHandler})]})]}),(null===(t=e.relatedStudent)||void 0===t?void 0:t.length)>0&&(0,i.jsx)("div",{className:l.Z.relStdShowDiv,children:null===(n=e.relatedStudent)||void 0===n?void 0:n.map((e=>(0,i.jsx)("span",{className:l.Z["margin-5"],children:e},e)))}),(0,i.jsx)(s.Z,{students:e.students,showOption:e.studentClickHandler,isSubject:e.isSubject})]})}},7287:(e,t,n)=>{n.d(t,{Z:()=>a});const a={form:"AttendanceForm_form__d8p8O",input:"AttendanceForm_input__euFwF",relStdShowDiv:"AttendanceForm_relStdShowDiv__McyvL",relStdArea:"AttendanceForm_relStdArea__kWci2","margin-5":"AttendanceForm_margin-5__6jnTk",btn:"AttendanceForm_btn__VV+7-",btnArea:"AttendanceForm_btnArea__eGu5D",optionsSet:"AttendanceForm_optionsSet__qPsn2"}}}]);